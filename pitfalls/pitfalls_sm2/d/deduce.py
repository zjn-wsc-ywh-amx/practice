from sm2 import *

p = 0xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF
a = 0xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC
b = 0x28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93
n = 0xFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123
G = (0x32C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7, 0xBC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0)

M1 = 111
M2 = 222
d1,Q1 = key()
d2,Q2 = key()
(r,s),k = sm2_sign(M1,G,d1,n)
(r2,s2),k2 = sm2_sign1(M2,G,d2,n,k)
print(sm2_verify(r,s,M1,Q1,n,k,d1))
print(sm2_verify(r2,s2,M2,Q2,n,k,d2))

df = (s-s2+d1*(s+r))*inverse(s2+r2,n) %n

if df == d2:
    print("siulfhgushuogyehijvhsidf!!!!!!!!!!!!!")